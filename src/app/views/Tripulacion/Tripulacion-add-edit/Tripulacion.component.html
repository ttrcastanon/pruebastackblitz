<section class="content">
  <div class="container-fluid">
    <div class="block-header">
      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <ul class="breadcrumb breadcrumb-style ">
            <li class="breadcrumb-item">
              <h4 class="page-title">Tripulación</h4>
            </li>
            <li class="breadcrumb-item bcrumb-1">
              <a routerLink="/dashboard/main">
                <i class="fas fa-home"></i> Inicio</a>
            </li>
            <li class="breadcrumb-item bcrumb-2">
              <a routerLink="/Tripulacion/list">Tripulación</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="flex-row clearfix">
      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
        <div class="card">
          <div class="body">
            <ngx-spinner name="loading" type="ball-spin-fade" fullScreen="false">
              <p style="color: white">Procesando</p>
            </ngx-spinner>
            <form class="m-4" [formGroup]="TripulacionForm" (ngSubmit)="save()">
              <mat-tab-group #tabGroup>
                <mat-tab aria-label="Datos_Generales" label="Datos Generales"> <br>
                  <div id="tabDatos_Generales" class="row">
                    <div id="divClave" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Piloto ID</mat-label>
                        <input matInput formControlName="Clave"
                          [type]="TripulacionForm.get('Clave').value == 'Auto' ? 'text':'number'" required />
                        <mat-error *ngIf="TripulacionForm.get('Clave').hasError('required')">
                          Piloto ID es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>

                    <div id="divNombres" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Nombre(s)</mat-label>
                        <input (change)="Nombres_ExecuteBusinessRules()" #Nombres matInput formControlName="Nombres"
                          type="text" maxlength="75" required />
                        <mat-error *ngIf="TripulacionForm.get('Nombres').hasError('required')">
                          Nombre(s) es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divApellido_paterno" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Apellido paterno</mat-label>
                        <input (change)="Apellido_paterno_ExecuteBusinessRules()" #Apellido_paterno matInput
                          formControlName="Apellido_paterno" type="text" maxlength="75" required />
                        <mat-error *ngIf="TripulacionForm.get('Apellido_paterno').hasError('required')">
                          Apellido paterno es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divApellido_materno" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Apellido materno</mat-label>
                        <input (change)="Apellido_materno_ExecuteBusinessRules()" #Apellido_materno matInput
                          formControlName="Apellido_materno" type="text" maxlength="75" required />
                        <mat-error *ngIf="TripulacionForm.get('Apellido_materno').hasError('required')">
                          Apellido materno es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divNombre_completo" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Nombre completo</mat-label>
                        <input (change)="Nombre_completo_ExecuteBusinessRules()" #Nombre_completo matInput
                          formControlName="Nombre_completo" type="text" maxlength="250" required />
                        <mat-error *ngIf="TripulacionForm.get('Nombre_completo').hasError('required')">
                          Nombre completo es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divDireccion" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Dirección</mat-label>
                        <input (change)="Direccion_ExecuteBusinessRules()" #Direccion matInput
                          formControlName="Direccion" type="text" maxlength="250" required />
                        <mat-error *ngIf="TripulacionForm.get('Direccion').hasError('required')">
                          Dirección es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divTelefono" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Teléfono</mat-label>
                        <input (change)="Telefono_ExecuteBusinessRules()" #Telefono matInput formControlName="Telefono"
                          type="text" maxlength="20" required placeholder="(XXX) XXX-XXXX" mask="(000) 000-0000"/>
                        <mat-error *ngIf="TripulacionForm.get('Telefono').hasError('required')">
                          Teléfono es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCelular" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Celular</mat-label>
                        <input (change)="Celular_ExecuteBusinessRules()" #Celular matInput formControlName="Celular"
                          type="text" maxlength="20" required placeholder="(XXX) XXX-XXXX" mask="(000) 000-0000"/>
                        <mat-error *ngIf="TripulacionForm.get('Celular').hasError('required')">
                          Celular es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCorreo_electronico" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Correo electrónico</mat-label>
                        <input (change)="Correo_electronico_ExecuteBusinessRules()" #Correo_electronico matInput
                          formControlName="Correo_electronico" type="text" maxlength="50" required />
                        <mat-error *ngIf="TripulacionForm.get('Correo_electronico').hasError('required')">
                          Correo electrónico es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_nacimiento" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de nacimiento</mat-label>
                        <input (dateChange)="Fecha_de_nacimiento_ExecuteBusinessRules()"
                          (blur)="Fecha_de_nacimiento_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_nacimiento.open()" [matDatepicker]="datePickerFecha_de_nacimiento"
                          formControlName="Fecha_de_nacimiento" [max]="today" type="text" required />
                        <mat-datepicker-toggle matSuffix [for]="datePickerFecha_de_nacimiento"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_nacimiento></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_nacimiento').hasError('required')">
                          Fecha de nacimiento es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divEdad" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Edad</mat-label>
                        <input (change)="Edad_ExecuteBusinessRules()" matInput formControlName="Edad"
                        type="text"
                        maxlength="10"
                          required />
                        <mat-error *ngIf="TripulacionForm.get('Edad').hasError('required')">
                          Edad es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divNacionalidad_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Nacionalidad (1)</mat-label>
                        <input type="text" matInput formControlName="Nacionalidad_1"
                          [matAutocomplete]="autoNacionalidad_1" required>
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoNacionalidad_1="matAutocomplete" [displayWith]="displayFnNacionalidad_1">
                          <mat-option (onSelectionChange)="Nacionalidad_1_ExecuteBusinessRules()"
                            *ngFor="let option of optionsNacionalidad_1 | async" [value]="option">
                            {{option.Nacionalidad}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingNacionalidad_1" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsNacionalidad_1 && !isLoadingNacionalidad_1">
                         
                        </mat-hint>
                        <mat-error *ngIf="TripulacionForm.get('Nacionalidad_1').hasError('required')">
                          Campo requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Nacionalidad_1').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un Nacionalidad (1) de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divNacionalidad_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Nacionalidad (2)</mat-label>
                        <input type="text" matInput formControlName="Nacionalidad_2"
                          [matAutocomplete]="autoNacionalidad_2">
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoNacionalidad_2="matAutocomplete" [displayWith]="displayFnNacionalidad_2">
                          <mat-option (onSelectionChange)="Nacionalidad_2_ExecuteBusinessRules()"
                            *ngFor="let option of optionsNacionalidad_2 | async" [value]="option">
                            {{option.Nacionalidad}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingNacionalidad_2" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsNacionalidad_2 && !isLoadingNacionalidad_2">
                         
                        </mat-hint>
                        <!-- <mat-error *ngIf="TripulacionForm.get('Nacionalidad_2').hasError('required')">
                          Campo requerido
                        </mat-error> -->
                        <mat-error *ngIf="TripulacionForm.get('Nacionalidad_2').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un Nacionalidad (2) de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divGenero" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Género</mat-label>
                        <mat-select (selectionChange)="Genero_ExecuteBusinessRules()" placeholder="Género"
                          formControlName="Genero" required>
                          <mat-option>

                          </mat-option>
                          <mat-option *ngFor="let item of varGenero" [value]="item.Clave">
                            {{ item.Descripcion }}
                          </mat-option>
                        </mat-select>
                        <mat-error *ngIf="TripulacionForm.get('Genero').hasError('required')">
                          Género es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divTipo_de_Tripulante" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Tipo de Tripulante</mat-label>
                        <mat-select (selectionChange)="Tipo_de_Tripulante_ExecuteBusinessRules()"
                          placeholder="Tipo de Tripulante" formControlName="Tipo_de_Tripulante" required>
                          <mat-option>

                          </mat-option>
                          <mat-option *ngFor="let item of varTipo_de_Tripulante" [value]="item.Clave">
                            {{ item.Descripcion }}
                          </mat-option>
                        </mat-select>
                        <mat-error *ngIf="TripulacionForm.get('Tipo_de_Tripulante').hasError('required')">
                          Tipo de Tripulante es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divPertenece_al_grupo" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Pertenece al grupo</mat-label>
                        <mat-select (selectionChange)="Pertenece_al_grupo_ExecuteBusinessRules()"
                          placeholder="Pertenece al grupo" formControlName="Pertenece_al_grupo" required>
                          <mat-option>

                          </mat-option>
                          <mat-option *ngFor="let item of varRespuesta" [value]="item.Clave">
                            {{ item.Descripcion }}
                          </mat-option>
                        </mat-select>
                        <mat-error *ngIf="TripulacionForm.get('Pertenece_al_grupo').hasError('required')">
                          Pertenece al grupo es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divEstatus" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Estatus</mat-label>
                        <mat-select (selectionChange)="Estatus_ExecuteBusinessRules()" placeholder="Estatus"
                          formControlName="Estatus" required>
                          <mat-option>

                          </mat-option>
                          <mat-option *ngFor="let item of varEstatus_Tripulacion" [value]="item.Clave">
                            {{ item.Descripcion }}
                          </mat-option>
                        </mat-select>
                        <mat-error *ngIf="TripulacionForm.get('Estatus').hasError('required')">
                          Estatus es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAeronaves" class="col">
                      <div class="table-responsive">
                        <div class="top-action-container-table">
                          <h4>Aeronaves</h4>
                          <button *ngIf="operation !== 'Consult'" color="primary" mat-mini-fab type="button"
                            (click)="addAeronavesToMR(); $event.stopPropagation();"(click)="MRaddAeronaves = true" [disabled]="MRaddAeronaves">
                            <mat-icon>add</mat-icon>
                          </button>
                        </div>
                        <table mat-table [dataSource]="dataSourceAeronaves" multiTemplateDataRows>

                          <ng-container *ngIf="!TripulacionForm.disabled" matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef>Acciones</th>
                            <mat-cell *matCellDef="let element;">
                              <div class="actions">
                                <button mat-icon-button class="btn-tbl-edit" type="button"
                                  (click)="editAeronaves(element);">
                                  <mat-icon>edit</mat-icon>
                                </button>
                                <button mat-icon-button class="btn-tbl-delete" type='button'
                                  (click)="deleteAeronaves(element); $event.stopPropagation();">
                                  <mat-icon>delete</mat-icon>
                                </button>
                              </div>
                            </mat-cell>
                          </ng-container>

                          <ng-container matColumnDef="Aeronave">
                            <th mat-header-cell *matHeaderCellDef> Aeronave</th>
                            <td mat-cell *matCellDef="let element">
                              {{element.Aeronave}}
                            </td>
                          </ng-container>

                          <ng-container matColumnDef="expandedDetail">
                            <td mat-cell *matCellDef="let element; let i = index;"
                              [attr.colspan]="getAeronavesColumns().length">

                              <div [@detailExpand]="collapseAll ? 'expanded':'collapsed' ">
                                <div *ngIf="element.edit">
                                  <form formArrayName="Tripulacion_AeronaveItems">

                                    <div class="row form-group"
                                      [formGroupName]="dataSourceAeronaves.data.indexOf(element)">

                                      <div class="col">
                                        <mat-form-field appearance="outline">
                                          <mat-label>Aeronave</mat-label>
                                          <input type="text" matInput formControlName="Aeronave"
                                            [matAutocomplete]="auto" required>
                                          <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                                          <mat-autocomplete
                                            (optionSelected)="selectAeronave_Tripulacion_Aeronave($event, element)"
                                            #auto="matAutocomplete"
                                            [displayWith]="displayFnAeronave_Tripulacion_Aeronave.bind(cthis, element)">
                                            <mat-option *ngFor="let option of varAeronave" [value]="option.Matricula"
                                              (onSelectionChange)="updateOptionAeronave_Tripulacion_Aeronave($event, element)">
                                              {{option.Matricula}}
                                            </mat-option>
                                            <mat-option *ngIf="isLoadingAeronave_Tripulacion_Aeronave"
                                              class="is-loading">
                                              <mat-spinner diameter="50"></mat-spinner>
                                            </mat-option>
                                          </mat-autocomplete>
                                          <mat-hint
                                            *ngIf="varAeronave.length ==0 &&  !isLoadingAeronave_Tripulacion_Aeronave && searchAeronave_Tripulacion_AeronaveCompleted">No
                                            se encontraron registros.</mat-hint>
                                        </mat-form-field>
                                      </div>

                                    </div>

                                    <div class="row">
                                      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                                        <button type='button' class="mr-3 btn-sm" mat-raised-button (click)="element.edit = false; saveAeronaves(element);"
                                          (click)="MRaddAeronaves = false" [disabled]="!AeronavesItems.valid" color="primary">Guardar
                                        </button>
                                        <button type="button" class="mr-3 btn-sm" mat-raised-button color="basic" (click)="MRaddAeronaves = false"
                                          (click)="cancelEditAeronaves(element)" mat-button>Cancelar</button>
                                      </div>
                                    </div>

                                  </form>
                                </div>
                              </div>
                            </td>
                          </ng-container>
                          <tr mat-header-row *matHeaderRowDef="getAeronavesColumns()"></tr>
                          <tr mat-row [ngClass]="{'hide': row.IsDeleted || (row.edit && row.Folio ==0 )}"
                            *matRowDef="let row; columns: getAeronavesColumns();let j = index"></tr>
                          <tr mat-row [ngClass]="{'hide': row.IsDeleted}"
                            *matRowDef="let row; columns: ['expandedDetail']; let j = index" class="example-detail-row">
                          </tr>
                        </table>
                        <mat-paginator #AeronavePaginator [length]="getCountAeronaves()" [pageSizeOptions]="[5, 10, 20]"
                          showFirstLastButtons>
                        </mat-paginator>

                      </div>
                    </div>
                    <div id="divUsuario_Relacionado" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Usuario Relacionado</mat-label>
                        <input type="text" matInput formControlName="Usuario_Relacionado"
                          [matAutocomplete]="autoUsuario_Relacionado">
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoUsuario_Relacionado="matAutocomplete"
                          [displayWith]="displayFnUsuario_Relacionado">
                          <mat-option (onSelectionChange)="Usuario_Relacionado_ExecuteBusinessRules()"
                            *ngFor="let option of optionsUsuario_Relacionado | async" [value]="option">
                            {{option.Nombre_completo}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingUsuario_Relacionado" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsUsuario_Relacionado && !isLoadingUsuario_Relacionado">
                         
                        </mat-hint>
                        <mat-error *ngIf="TripulacionForm.get('Usuario_Relacionado').hasError('required')">
                          Campo requerido
                        </mat-error>
                        <mat-error
                          *ngIf="TripulacionForm.get('Usuario_Relacionado').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un Usuario Relacionado de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFotografia" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="FotografiaName == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fotografía</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="FotografiaFile" required>
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('FotografiaFile').hasError('required')">
                          Fotografía es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="FotografiaName != '' ">
                        <mat-label>Fotografía</mat-label>
                        <a href="{{FotografiaUrl()}}" target="_blank">
                          {{FotografiaName }}
                        </a>
                        <button mat-icon-button (click)="removeFotografia()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </div>
                </mat-tab>

                <mat-tab aria-label="Documentos" label="Documentos"> <br>
                  <div id="tabDocumentos" class="row">
                    <div id="divNumero_de_Licencia" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Número de Licencia</mat-label>
                        <input (change)="Numero_de_Licencia_ExecuteBusinessRules()" #Numero_de_Licencia matInput
                          formControlName="Numero_de_Licencia" type="text" maxlength="50" required />
                        <mat-error *ngIf="TripulacionForm.get('Numero_de_Licencia').hasError('required')">
                          Número de Licencia es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_Licencia" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión Licencia</mat-label>
                        <input (dateChange)="Fecha_de_Emision_Licencia_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_Licencia_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_Licencia.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_Licencia"
                          formControlName="Fecha_de_Emision_Licencia" 
                          (keypress)="soloFecha($event)" [max]="today" type="text" required />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_Licencia"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_Licencia></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Licencia').hasError('required')">
                          Fecha de Emisión Licencia es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Licencia').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_licencia" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_licencia_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_licencia_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_licencia.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_licencia"
                          formControlName="Fecha_de_vencimiento_licencia"  (keypress)="soloFecha($event)"
                           [min]="TripulacionForm.get('Fecha_de_Emision_Licencia').value || today" type="text" required />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_licencia"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_licencia></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_licencia').hasError('required')">
                          Fecha de vencimiento es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_licencia').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_licencia" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_licencia_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_licencia" class="example-margin">
                        Alerta de vencimiento
                      </mat-checkbox>
                    </div>
                    <div id="divCargar_Licencia" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_LicenciaName == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Licencia</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_LicenciaFile" required>
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_LicenciaFile').hasError('required')">
                          Cargar Licencia es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_LicenciaName != '' ">
                        <mat-label>Cargar Licencia</mat-label>
                        <a href="{{Cargar_LicenciaUrl()}}" target="_blank">
                          {{Cargar_LicenciaName }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Licencia()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div id="divCertificado_Medico" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Certificado Médico</mat-label>
                        <input (change)="Certificado_Medico_ExecuteBusinessRules()" #Certificado_Medico matInput
                          formControlName="Certificado_Medico" type="text" maxlength="50" required />
                        <mat-error *ngIf="TripulacionForm.get('Certificado_Medico').hasError('required')">
                          Certificado Médico es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_Certificado" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión Certificado</mat-label>
                        <input (dateChange)="Fecha_de_Emision_Certificado_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_Certificado_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_Certificado.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_Certificado"
                          formControlName="Fecha_de_Emision_Certificado"
                          (keypress)="soloFecha($event)"  [max]="today" type="text" required />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_Certificado"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_Certificado></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Certificado').hasError('required')">
                          Fecha de Emisión Certificado es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Certificado').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_certificado" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_certificado_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_certificado_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_certificado.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_certificado"
                          formControlName="Fecha_de_vencimiento_certificado"
                          (keypress)="soloFecha($event)" type="text" required [min]="TripulacionForm.get('Fecha_de_Emision_Certificado').value || today"/>
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_certificado"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_certificado></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_certificado').hasError('required')">
                          Fecha de vencimiento es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_certificado').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_certificado" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_certificado_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_certificado" class="example-margin">
                        Alerta de vencimiento
                      </mat-checkbox>
                    </div>
                    <div id="divCargar_Certificado_Medico" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_Certificado_MedicoName == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Certificado Médico</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_Certificado_MedicoFile" required>
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_Certificado_MedicoFile').hasError('required')">
                          Cargar Certificado Médico es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_Certificado_MedicoName != '' ">
                        <mat-label>Cargar Certificado Médico</mat-label>
                        <a href="{{Cargar_Certificado_MedicoUrl()}}" target="_blank">
                          {{Cargar_Certificado_MedicoName }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Certificado_Medico()"
                          *ngIf="!TripulacionForm.disabled" [hidden]="operation == 'Consult'">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div id="divNumero_de_Pasaporte_1" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Número de Pasaporte (1)</mat-label>
                        <input (change)="Numero_de_Pasaporte_1_ExecuteBusinessRules()" #Numero_de_Pasaporte_1 matInput
                          formControlName="Numero_de_Pasaporte_1" type="text" maxlength="50" />
                        <mat-error *ngIf="TripulacionForm.get('Numero_de_Pasaporte_1').hasError('required')">
                          Número de Pasaporte (1) es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_Pasaporte_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión Pasaporte (1)</mat-label>
                        <input (dateChange)="Fecha_de_Emision_Pasaporte_1_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_Pasaporte_1_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_Pasaporte_1.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_Pasaporte_1"
                          formControlName="Fecha_de_Emision_Pasaporte_1"
                          (keypress)="soloFecha($event)" [max]="today" type="text" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_Pasaporte_1"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_Pasaporte_1></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Pasaporte_1').hasError('required')">
                          Fecha de Emisión Pasaporte (1) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Pasaporte_1').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy

                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_Pasaporte_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento Pasaporte (1)</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_Pasaporte_1_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_Pasaporte_1_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_Pasaporte_1.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_Pasaporte_1"
                          formControlName="Fecha_de_vencimiento_Pasaporte_1" type="text" 
                          (keypress)="soloFecha($event)" [min]="TripulacionForm.get('Fecha_de_Emision_Pasaporte_1').value || today" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_Pasaporte_1"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_Pasaporte_1></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Pasaporte_1').hasError('required')">
                          Fecha de vencimiento Pasaporte (1) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Pasaporte_1').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_Pasaporte_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_Pasaporte_1_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_Pasaporte_1" class="example-margin">
                        Alerta de vencimiento Pasaporte (1)
                      </mat-checkbox>
                    </div>
                    <div id="divPais_1" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>País</mat-label>
                        <input type="text" matInput formControlName="Pais_1"  [matAutocomplete]="autoPais_1">
                        <mat-icon style="font-size: 24px;" matSuffix> </mat-icon>
                        <mat-autocomplete #autoPais_1="matAutocomplete" [displayWith]="displayFnPais_1">
                          <mat-option (onSelectionChange)="Pais_1_ExecuteBusinessRules()"
                            *ngFor="let option of optionsPais_1 | async" [value]="option">
                            {{option.Nombre}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingPais_1" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsPais_1 && !isLoadingPais_1">
                         
                        </mat-hint>
                        <!-- <mat-error *ngIf="TripulacionForm.get('Pais_1').hasError('required')">
                          Campo requerido
                        </mat-error> -->
                        <mat-error *ngIf="TripulacionForm.get('Pais_1').value">
                          Valor inválido. Seleccione un País de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCargar_Pasaporte_1" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_Pasaporte_1Name == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Pasaporte (1)</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_Pasaporte_1File">
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_Pasaporte_1File').hasError('required')">
                          Cargar Pasaporte (1) es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_Pasaporte_1Name != '' ">
                        <mat-label>Cargar Pasaporte (1)</mat-label>
                        <a href="{{Cargar_Pasaporte_1Url()}}" target="_blank">
                          {{Cargar_Pasaporte_1Name }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Pasaporte_1()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div id="divNumero_de_Pasaporte_2" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Número de Pasaporte (2)</mat-label>
                        <input (change)="Numero_de_Pasaporte_2_ExecuteBusinessRules()" #Numero_de_Pasaporte_2 matInput
                          formControlName="Numero_de_Pasaporte_2" type="text" maxlength="50" />
                        <mat-error *ngIf="TripulacionForm.get('Numero_de_Pasaporte_2').hasError('required')">
                          Número de Pasaporte (2) es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_Pasaporte_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión Pasaporte (2)</mat-label>
                        <input (dateChange)="Fecha_de_Emision_Pasaporte_2_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_Pasaporte_2_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_Pasaporte_2.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_Pasaporte_2"
                          formControlName="Fecha_de_Emision_Pasaporte_2"
                          (keypress)="soloFecha($event)" [max]="today" type="text" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_Pasaporte_2"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_Pasaporte_2></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Pasaporte_2').hasError('required')">
                          Fecha de Emisión Pasaporte (2) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Pasaporte_2').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy
                         </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_Pasaporte_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento Pasaporte (2)</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_Pasaporte_2_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_Pasaporte_2_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_Pasaporte_2.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_Pasaporte_2"
                          formControlName="Fecha_de_vencimiento_Pasaporte_2"
                          (keypress)="soloFecha($event)" type="text" [min]="TripulacionForm.get('Fecha_de_Emision_Pasaporte_2').value || today" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_Pasaporte_2"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_Pasaporte_2></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Pasaporte_2').hasError('required')">
                          Fecha de vencimiento Pasaporte (2) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Pasaporte_2').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_Pasaporte_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_Pasaporte_2_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_Pasaporte_2" class="example-margin">
                        Alerta de vencimiento Pasaporte (2)
                      </mat-checkbox>
                    </div>
                    <div id="divPais_2" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>País</mat-label>
                        <input type="text" matInput formControlName="Pais_2" [matAutocomplete]="autoPais_2">
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoPais_2="matAutocomplete" [displayWith]="displayFnPais_2">
                          <mat-option (onSelectionChange)="Pais_2_ExecuteBusinessRules()"
                            *ngFor="let option of optionsPais_2 | async" [value]="option">
                            {{option.Nombre}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingPais_2" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsPais_2 && !isLoadingPais_2">
                         
                        </mat-hint>
                        <mat-error *ngIf="TripulacionForm.get('Pais_2').hasError('required')">
                          Campo requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Pais_2').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un País de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCargar_Pasaporte_2" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_Pasaporte_2Name == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Pasaporte (2)</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_Pasaporte_2File">
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_Pasaporte_2File').hasError('required')">
                          Cargar Pasaporte (2) es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_Pasaporte_2Name != '' ">
                        <mat-label>Cargar Pasaporte (2)</mat-label>
                        <a href="{{Cargar_Pasaporte_2Url()}}" target="_blank">
                          {{Cargar_Pasaporte_2Name }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Pasaporte_2()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div id="divNumero_de_Visa_1" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Número de Visa (1)</mat-label>
                        <input (change)="Numero_de_Visa_1_ExecuteBusinessRules()" #Numero_de_Visa_1 matInput
                          formControlName="Numero_de_Visa_1" type="text" maxlength="50" />
                        <mat-error *ngIf="TripulacionForm.get('Numero_de_Visa_1').hasError('required')">
                          Número de Visa (1) es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_visa_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión visa (1)</mat-label>
                        <input (dateChange)="Fecha_de_Emision_visa_1_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_visa_1_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_visa_1.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_visa_1" formControlName="Fecha_de_Emision_visa_1"
                          [max]="today" type="text" (keypress)="soloFecha($event)" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_visa_1"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_visa_1></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_visa_1').hasError('required')">
                          Fecha de Emisión visa (1) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_visa_1').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_Visa_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento Visa (1)</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_Visa_1_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_Visa_1_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_Visa_1.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_Visa_1"
                          formControlName="Fecha_de_vencimiento_Visa_1" type="text" 
                          (keypress)="soloFecha($event)" [min]="TripulacionForm.get('Fecha_de_Emision_visa_1').value || today"/>
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_Visa_1"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_Visa_1></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Visa_1').hasError('required')">
                          Fecha de vencimiento Visa (1) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Visa_1').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_Visa_1" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_Visa_1_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_Visa_1" class="example-margin">
                        Alerta de vencimiento Visa (1)
                      </mat-checkbox>
                    </div>
                    <div id="divPais_3" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>País</mat-label>
                        <input type="text" matInput formControlName="Pais_3" [matAutocomplete]="autoPais_3">
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoPais_3="matAutocomplete" [displayWith]="displayFnPais_3">
                          <mat-option (onSelectionChange)="Pais_3_ExecuteBusinessRules()"
                            *ngFor="let option of optionsPais_3 | async" [value]="option">
                            {{option.Nombre}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingPais_3" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsPais_3 && !isLoadingPais_3">
                         
                        </mat-hint>
                        <mat-error *ngIf="TripulacionForm.get('Pais_3').hasError('required')">
                          Campo requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Pais_3').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un País de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCargar_Visa_1" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_Visa_1Name == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Visa (1)</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_Visa_1File">
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_Visa_1File').hasError('required')">
                          Cargar Visa (1) es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_Visa_1Name != '' ">
                        <mat-label>Cargar Visa (1)</mat-label>
                        <a href="{{Cargar_Visa_1Url()}}" target="_blank">
                          {{Cargar_Visa_1Name }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Visa_1()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                    <div id="divNumero_de_Visa_2" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Número de Visa (2)</mat-label>
                        <input (change)="Numero_de_Visa_2_ExecuteBusinessRules()" #Numero_de_Visa_2 matInput
                          formControlName="Numero_de_Visa_2" type="text" maxlength="50" />
                        <mat-error *ngIf="TripulacionForm.get('Numero_de_Visa_2').hasError('required')">
                          Número de Visa (2) es requerido
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_Emision_Visa_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de Emisión Visa (2)</mat-label>
                        <input (dateChange)="Fecha_de_Emision_Visa_2_ExecuteBusinessRules()"
                          (blur)="Fecha_de_Emision_Visa_2_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_Emision_Visa_2.open()"
                          [matDatepicker]="datePickerFecha_de_Emision_Visa_2" formControlName="Fecha_de_Emision_Visa_2"
                          [max]="today" type="text" (keypress)="soloFecha($event)" />
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_Emision_Visa_2"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_Emision_Visa_2></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Visa_2').hasError('required')">
                          Fecha de Emisión Visa (2) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_Emision_Visa_2').hasError('matDatepickerMax')">
                          Fecha de Emisión no puede ser mayor a hoy
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divFecha_de_vencimiento_Visa_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>Fecha de vencimiento Visa (2)</mat-label>
                        <input (dateChange)="Fecha_de_vencimiento_Visa_2_ExecuteBusinessRules()"
                          (blur)="Fecha_de_vencimiento_Visa_2_ExecuteBusinessRules()" matInput
                          (focus)="datePickerFecha_de_vencimiento_Visa_2.open()"
                          [matDatepicker]="datePickerFecha_de_vencimiento_Visa_2"
                          formControlName="Fecha_de_vencimiento_Visa_2" type="text"
                          (keypress)="soloFecha($event)" [min]="TripulacionForm.get('Fecha_de_Emision_Visa_2').value || today"/>
                        <mat-datepicker-toggle matSuffix
                          [for]="datePickerFecha_de_vencimiento_Visa_2"></mat-datepicker-toggle>
                        <mat-datepicker #datePickerFecha_de_vencimiento_Visa_2></mat-datepicker>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Visa_2').hasError('required')">
                          Fecha de vencimiento Visa (2) es requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Fecha_de_vencimiento_Visa_2').hasError('matDatepickerMin')">
                          Fecha de vencimiento tiene que ser mayor al de emisión
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divAlerta_de_vencimiento_Visa_2" class="col-xl-4 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-checkbox (change)="Alerta_de_vencimiento_Visa_2_ExecuteBusinessRules()"
                        formControlName="Alerta_de_vencimiento_Visa_2" class="example-margin">
                        Alerta de vencimiento Visa (2)
                      </mat-checkbox>
                    </div>
                    <div id="divPais_4" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field class="example-full-width no-padding" appearance="outline">
                        <mat-label>País</mat-label>
                        <input type="text" matInput formControlName="Pais_4" [matAutocomplete]="autoPais_4">
                        <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                        <mat-autocomplete #autoPais_4="matAutocomplete" [displayWith]="displayFnPais_4">
                          <mat-option (onSelectionChange)="Pais_4_ExecuteBusinessRules()"
                            *ngFor="let option of optionsPais_4 | async" [value]="option">
                            {{option.Nombre}}
                          </mat-option>
                          <mat-option *ngIf="isLoadingPais_4" class="is-loading">
                            <mat-spinner diameter="30"></mat-spinner>
                          </mat-option>
                        </mat-autocomplete>
                        <mat-hint *ngIf="!hasOptionsPais_4 && !isLoadingPais_4">
                         
                        </mat-hint>
                        <mat-error *ngIf="TripulacionForm.get('Pais_4').hasError('required')">
                          Campo requerido
                        </mat-error>
                        <mat-error *ngIf="TripulacionForm.get('Pais_4').hasError('invalidAutocompleteValue')">
                          Valor inválido. Seleccione un País de la lista de opciones.
                        </mat-error>
                      </mat-form-field>
                    </div>
                    <div id="divCargar_Visa_2" class="col-xl-6 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <mat-form-field *ngIf="Cargar_Visa_2Name == '' && !TripulacionForm.disabled"
                        class="example-full-width no-padding" appearance="outline">
                        <mat-label>Cargar Visa (2)</mat-label>
                        <ngx-mat-file-input #removableInput formControlName="Cargar_Visa_2File">
                        </ngx-mat-file-input>
                        <button type="button" mat-icon-button matSuffix *ngIf="!removableInput.empty"
                          (click)="removableInput.clear($event)">
                          <mat-icon>clear</mat-icon>
                        </button>
                        <mat-error *ngIf="TripulacionForm.get('Cargar_Visa_2File').hasError('required')">
                          Cargar Visa (2) es requerido
                        </mat-error>
                      </mat-form-field>
                      <div *ngIf="Cargar_Visa_2Name != '' ">
                        <mat-label>Cargar Visa (2)</mat-label>
                        <a href="{{Cargar_Visa_2Url()}}" target="_blank">
                          {{Cargar_Visa_2Name }}
                        </a>
                        <button mat-icon-button (click)="removeCargar_Visa_2()" [hidden]="operation == 'Consult'" *ngIf="!TripulacionForm.disabled">
                          <mat-icon aria-label="eliminar">close</mat-icon>
                        </button>
                      </div>
                    </div>
                  </div>
                </mat-tab>

                <mat-tab aria-label="Cursos" label="Cursos"> <br>
                  <div id="tabCursos" class="row">
                    <div id="divCursos" class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                      <div class="table-responsive">
                        <div class="top-action-container-table">
                          <h4>Cursos</h4>
                          <button *ngIf="operation !== 'Consult'" color="primary" mat-mini-fab type="button"
                            (click)="addCursosToMR(); $event.stopPropagation();"(click)="MRaddCursos = true" [disabled]="MRaddCursos">
                            <mat-icon>add</mat-icon>
                          </button>
                        </div>
                        <table mat-table [dataSource]="dataSourceCursos" multiTemplateDataRows>

                          <ng-container *ngIf="!TripulacionForm.disabled" matColumnDef="actions">
                            <th mat-header-cell *matHeaderCellDef>Acciones</th>
                            <mat-cell *matCellDef="let element;">
                              <div class="actions">
                                <button mat-icon-button class="btn-tbl-edit" type="button"
                                  (click)="editCursos(element);">
                                  <mat-icon>edit</mat-icon>
                                </button>
                                <button mat-icon-button class="btn-tbl-delete" type='button'
                                  (click)="deleteCursos(element); $event.stopPropagation();">
                                  <mat-icon>delete</mat-icon>
                                </button>
                              </div>
                            </mat-cell>
                          </ng-container>

                          <ng-container matColumnDef="MODELO">
                            <th mat-header-cell *matHeaderCellDef> MODELO</th>
                            <td mat-cell *matCellDef="let element"> {{element.MODELO_Modelos?.Descripcion}}
                            </td>
                          </ng-container>
                          <ng-container matColumnDef="TIPO_DE_CURSO">
                            <th mat-header-cell *matHeaderCellDef> TIPO DE CURSO</th>
                            <td mat-cell *matCellDef="let element">
                              {{element.TIPO_DE_CURSO_Tipos_de_Curso?.Descripcion}}
                            </td>
                          </ng-container>
                          <ng-container matColumnDef="DESCRIPCION">
                            <th mat-header-cell *matHeaderCellDef> DESCRIPCIÓN </th>
                            <td mat-cell *matCellDef="let element"> {{element.DESCRIPCION}} </td>
                          </ng-container>
                          <ng-container matColumnDef="FECHA_DE_VENCIMIENT">
                            <th mat-header-cell *matHeaderCellDef> FECHA DE VENCIMIENTO </th>
                            <td mat-cell *matCellDef="let element"> {{element.FECHA_DE_VENCIMIENT |  date: 'dd-MM-yyyy'}} </td>
                          </ng-container>
                          <ng-container matColumnDef="DOCUMENTO">
                            <th mat-header-cell *matHeaderCellDef>DOCUMENTO</th>
                            <td mat-cell *matCellDef="let element">
                              <div class="text-center f-w" *ngIf="element.DOCUMENTO_Spartane_File">
                                <a *ngIf="element.Clave > 0" mat-button class="btn-tbl-foto"
                                  [disabled]="!element.DOCUMENTO"
                                  [href]="spartanFileService.url(element.DOCUMENTO_Spartane_File.File_Id,element.DOCUMENTO_Spartane_File.Description)"
                                  target="_blank" matTooltip="DOCUMENTO">
                                  <mat-icon>image_search</mat-icon>
                                  <span>{{ element.DOCUMENTO_Spartane_File.Description }}</span>
                                </a>
                              </div>
                              <a *ngIf="getDOCUMENTO_Detalle_Cursos_de_Tripulacion(element) != ''" mat-button
                                class="btn-tbl-foto" href="#"
                                (click)="getDOCUMENTO_Detalle_Cursos_de_TripulacionClick(element); $event.stopPropagation();$event.preventDefault();">
                                {{getDOCUMENTO_Detalle_Cursos_de_Tripulacion(element)}}
                              </a>
                            </td>
                          </ng-container>


                          <ng-container matColumnDef="expandedDetail">
                            <td mat-cell *matCellDef="let element; let i = index;"
                              [attr.colspan]="getCursosColumns().length">

                              <div [@detailExpand]="collapseAll ? 'expanded':'collapsed' ">
                                <div *ngIf="element.edit">
                                  <form formArrayName="Detalle_Cursos_de_TripulacionItems">

                                    <div class="row form-group"
                                      [formGroupName]="dataSourceCursos.data.indexOf(element)">

                                      <div class="col-xs-12 col-sm-6 col-lg-4 col-xl-3">
                                        <mat-form-field appearance="outline">
                                          <mat-label>MODELO</mat-label>
                                          <input type="text" matInput formControlName="MODELO" [matAutocomplete]="auto">
                                          <mat-icon style="font-size: 24px;" matSuffix>arrow_drop_down</mat-icon>
                                          <mat-autocomplete
                                            (optionSelected)="selectMODELO_Detalle_Cursos_de_Tripulacion($event, element)"
                                            #auto="matAutocomplete"
                                            [displayWith]="displayFnMODELO_Detalle_Cursos_de_Tripulacion.bind(cthis, element)">
                                            <mat-option *ngFor="let option of varModelos" [value]="option.Clave"
                                              (onSelectionChange)="updateOptionMODELO_Detalle_Cursos_de_Tripulacion($event, element)">
                                              {{option.Descripcion}}
                                            </mat-option>
                                            <mat-option *ngIf="isLoadingMODELO_Detalle_Cursos_de_Tripulacion"
                                              class="is-loading">
                                              <mat-spinner diameter="50"></mat-spinner>
                                            </mat-option>
                                          </mat-autocomplete>
                                          <!-- <mat-hint
                                            *ngIf="varModelos.length ==0 &&  !isLoadingMODELO_Detalle_Cursos_de_Tripulacion && searchMODELO_Detalle_Cursos_de_TripulacionCompleted">No
                                            se encontraron registros.</mat-hint> -->
                                        </mat-form-field>
                                      </div>
                                      <div class="col-xs-12 col-sm-6 col-lg-4 col-xl-3">
                                        <mat-form-field appearance="outline">
                                          <mat-label>TIPO DE CURSO</mat-label>
                                          <mat-select placeholder="TIPO DE CURSO" formControlName="TIPO_DE_CURSO">
                                            <mat-option>
                                            </mat-option>
                                            <mat-option *ngFor="let item of varTipos_de_Curso" [value]="item.Clave">
                                              {{ item.Descripcion }}
                                            </mat-option>
                                          </mat-select>
                                        </mat-form-field>
                                      </div>
                                      <div class="col-xs-12 col-sm-6 col-lg-4 col-xl-3">
                                        <mat-form-field appearance="outline">
                                          <mat-label>DESCRIPCIÓN</mat-label>
                                          <input matInput formControlName="DESCRIPCION" maxlength="150" type="text" />
                                        </mat-form-field>
                                      </div>
                                      <div class="col-xs-12 col-sm-6 col-lg-4 col-xl-3">
                                        <mat-form-field appearance="outline">
                                          <mat-label>FECHA DE VENCIMIENTO</mat-label>
                                          <input matInput (focus)="rpicker.open()" [matDatepicker]="rpicker"
                                            formControlName="FECHA_DE_VENCIMIENT" type="text" />
                                          <mat-datepicker-toggle matSuffix [for]="rpicker"></mat-datepicker-toggle>
                                          <mat-datepicker #rpicker></mat-datepicker>
                                        </mat-form-field>
                                      </div>
                                      <div class="col-xs-12 col-sm-6 col-lg-4 col-xl-3">
                                        <mat-form-field *ngIf="!hasDOCUMENTO_Detalle_Cursos_de_Tripulacion(element)"
                                          class="example-full-width no-padding" appearance="outline">
                                          <mat-label>DOCUMENTO</mat-label>
                                          <ngx-mat-file-input #removableInputFamiliar formControlName="DOCUMENTOFile">
                                          </ngx-mat-file-input>
                                          <button mat-icon-button matSuffix *ngIf="!removableInputFamiliar.empty"
                                            (click)="removableInputFamiliar.clear($event)">
                                            <mat-icon>clear</mat-icon>
                                          </button>
                                        </mat-form-field>
                                        <div style="padding-left: 5px;"
                                          *ngIf="hasDOCUMENTO_Detalle_Cursos_de_Tripulacion(element)">
                                          <mat-label>DOCUMENTO</mat-label><br>
                                          <div *ngIf="element.DOCUMENTO_Spartane_File">
                                            <a [href]="spartanFileService.url(element.DOCUMENTO_Spartane_File.File_Id,element.DOCUMENTO_Spartane_File.Description)"
                                              role="button" target="_blank">
                                              {{ element.DOCUMENTO_Spartane_File.Description }}
                                            </a>
                                          </div>
                                          <a *ngIf="getDOCUMENTO_Detalle_Cursos_de_Tripulacion(element) != ''"
                                            mat-button class="btn-tbl-foto" href="#"
                                            (click)="getDOCUMENTO_Detalle_Cursos_de_TripulacionClick(element); $event.stopPropagation(); $event.preventDefault();">
                                            {{getDOCUMENTO_Detalle_Cursos_de_Tripulacion(element)}}
                                          </a>
                                          <button mat-icon-button
                                            (click)="removeDOCUMENTO_Detalle_Cursos_de_Tripulacion(element)"
                                            *ngIf="!TripulacionForm.disabled" [hidden]="operation == 'Consult'">
                                            <mat-icon aria-label="eliminar">close</mat-icon>
                                          </button>
                                        </div>
                                      </div>

                                    </div>
          
                                    <div class="row">
                                      <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                                        <button type='button' class="mr-3 btn-sm" mat-raised-button
                                          (click)="element.edit = false; saveCursos(element); " (click)="MRaddCursos = false" color="primary">Guardar
                                        </button>
                                        <button type="button" class="mr-3 btn-sm" mat-raised-button color="basic"
(click)="MRaddCursos = false"                                          (click)="cancelEditCursos(element)" mat-button>Cancelar</button>
                                      </div>
                                    </div>

                                  </form>
                                </div>
                              </div>
                            </td>
                          </ng-container>
                          <tr mat-header-row *matHeaderRowDef="getCursosColumns()"></tr>
                          <tr mat-row [ngClass]="{'hide': row.IsDeleted || (row.edit)}"
                            *matRowDef="let row; columns: getCursosColumns();let j = index"></tr>
                          <tr mat-row [ngClass]="{'hide': row.IsDeleted}"
                            *matRowDef="let row; columns: ['expandedDetail']; let j = index" class="example-detail-row">
                          </tr>
                        </table>
                        <mat-paginator #CursosPaginator [length]="getCountCursos()" [pageSizeOptions]="[5, 10, 20]"
                          showFirstLastButtons>
                        </mat-paginator>

                      </div>
                    </div>

                  </div>
                </mat-tab>
              </mat-tab-group>
              <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 mb-2">
                  <button type="submit" class="mr-3 mb-2" [disabled]="!TripulacionForm.valid || consult"
                    mat-raised-button color="primary">Guardar
                  </button>
                  <button type='button' class="mr-3 mb-2" (click)="saveAndNew()"
                    [disabled]="!TripulacionForm.valid || consult" mat-raised-button color="primary" hidden>Guardar y
                    Nuevo
                  </button>
                  <button type='button' class="mr-3 mb-2" (click)="saveAndCopy()"
                    [disabled]="!TripulacionForm.valid || consult" mat-raised-button color="primary" hidden>Guardar y
                    Nuevo
                  </button>
                  <button [hidden]="!hasPermision('Configure')" class="mr-3 mb-2"
                    [disabled]="!TripulacionForm.valid || consult" mat-raised-button color="primary">Configurar
                  </button>
                  <button type="button" class="mb-2" mat-raised-button color="basic" (click)="cancel()"
                    mat-button>Cancelar</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<div id="snackbar"></div>
